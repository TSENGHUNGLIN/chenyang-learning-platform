# 晨陽同仁成長分析 - 專案待辦事項

## 資料庫架構
- [x] 設計使用者表格（擴展邀請制存取控制）
- [x] 設計部門表格（業管部、行銷部、設計部、業務部、工務部）
- [x] 設計人員表格（關聯部門）
- [x] 設計檔案上傳表格（關聯人員、日期、檔案路徑）
- [x] 設計角色權限表格（管理員、編輯者、訪客、未授權）
- [ ] 批次更新所有 "manual" 登入方式的使用者為 "google"

## 後端API
- [x] 實作部門管理API（新增、查詢、編輯、刪除）
- [x] 實作人員管理API（新增、查詢、編輯、刪除）
- [x] 實作檔案上傳API（上傳至S3、儲存metadata）
- [x] 實作檔案查詢API（依日期、部門、人員篩選）
- [x] 實作搜尋API（關鍵字搜尋檔案內容）
- [x] 實作AI分析API（使用Manus內建AI）
- [ ] 實作使用者審核API（批准、拒絕）
- [x] 實作角色權限控制API

## 前端介面
- [x] 設計整體佈局與導航結構
- [x] 實作登入頁面（Google OAuth）
- [x] 實作待審核使用者頁面
- [x] 實作主頁面（日曆視圖）
- [x] 實作日曆元件（顯示上傳日期、顏色區分）
- [x] 實作部門下拉選單
- [x] 實作人員下拉選單
- [x] 實作檔案上傳介面（支援PDF、DOCX）
- [x] 實作檔案列表顯示
- [x] 實作搜尋欄位（關鍵字高亮顯示）
- [x] 實作AI分析欄位
- [x] 實作使用者管理頁面（僅管理員）
- [x] 實作角色權限管理介面

## 權限控制
- [x] 實作邀請制存取控制（新使用者待審核）
- [x] 實作專案擁有者自動批准
- [x] 實作管理員審核功能（批准/拒絕）
- [x] 實作刪除使用者後重新審核機制
- [x] 實作管理員權限（所有權限）
- [x] 實作編輯者權限（查看、編輯、匯出）
- [x] 實作訪客權限（僅查看）
- [x] 實作未授權使用者處理（無權限）

## 檔案處理
- [x] 實作PDF檔案上傳與儲存
- [x] 實作DOCX檔案上傳與儲存
- [x] 實作檔案內容提取（用於搜尋）
- [x] 實作檔案下載功能

## AI整合
- [x] 整合Manus內建AI API
- [x] 實作檔案內容AI分析功能
- [x] 實作分析結果顯示

## 初始資料
- [x] 建立業務部部門資料
- [x] 建立蔣昆真人員資料
- [x] 建立邱紫郁人員資料
- [ ] 上傳蔣昆真考核檔案
- [ ] 上傳邱紫郁考核檔案轉正考核問答檔案

## 測試與部署
- [ ] 測試完整使用者流程
- [ ] 測試權限控制機制
- [ ] 測試檔案上傳與搜尋功能
- [ ] 測試AI分析功能
- [ ] 建立checkpoint
- [ ] 部署網站



## Bug修復
- [x] 修復Home.tsx中嵌套的<a>標籤錯誤



## 新功能
- [x] 支援多檔案上傳（一次最多5個檔案）
- [x] 顯示上傳進度
- [x] 批次上傳結果反饋



- [x] 上傳時先選擇部門，再選擇該部門的人員



- [x] 新增檔案刪除功能
- [x] 檔案列表依部門和人員篩選



## Bug修復
- [x] 修復已發布網站中管理者帳號為待審核狀態的問題



## 新功能
- [x] 新增部門管理介面（新增、編輯、刪除部門）
- [x] 新增人員管理介面（新增、編輯、刪除人員）
- [x] 為部門管理新增編輯和刪除功能
- [x] 為人員管理新增編輯和刪除功能



## Bug修復
- [x] 修復管理員在正式網站仍顯示待審核頁面的問題



## 搜尋功能優化
- [x] 實作進階篩選組合（部門 + 人員 + 日期範圍）
- [x] 實作分頁顯示（每頲20筆）
- [x] 實作搜尋防抖（debounce）



## 首頁優化
- [x] 在首頁新增搜尋欄位



## 搜尋功能增強
- [x] 支援搜尋人員姓名以找到該人員的所有檔案
- [x] 支援搜尋部門名稱以找到該部門的所有檔案



## 系統名稱修改
- [x] 將系統名稱從「晨陽新人成長學習題庫分析系統」改為「晨陽同仁成長分析」



## 檔案上傳功能擴展
- [x] 支援Google雲端文件連結上傳
- [x] 支援Google文件形式檔案
- [x] 支援直接貼文（文字內容）



## 日曆顯示優化
- [x] 在日曆中顯示人名而非檔案名稱
- [x] 當同一人有多篇文章時顯示文章數量（例如：蔣昆真 (3篇)）



## 檔案追蹤功能
- [x] 新增資料更新日期時間欄位
- [x] 新增閱讀資料日期時間欄位
- [x] 在檔案列表中顯示更新和閱讀時間
- [x] 記錄使用者閱讀檔案的行為



## Bug修復
- [x] 修復使用者管理頁面404錯誤



## 品牌更新
- [x] 更新 favicon 為晨陽 LOGO
- [x] 更新網站內 LOGO 為晨陽 LOGO



## 自動新增人員功能
- [x] 上傳檔案時可選擇「新增人員」選項
- [x] 從檔案名稱自動提取人員姓名
- [x] 自動將新人員加入所選部門
- [x] 在部門同仁管理頁面可編輯自動新增的人員



## Bug修復 - 自動識別新人功能
- [x] 修正姓名提取邏輯，正確從「初階報價專課程 – Eva – 湯芸珠薪酬細節.pdf」中識別出「湯芸珠」（目前誤識為「初階」）
- [x] 允許沒有姓名也能上傳檔案，之後由人工分類



## Bug修復 - 檔案名稱亂碼
- [x] 修正上傳API的中文檔案名稱編碼問題（例如：湯芸琇測驗回饋.pdf 顯示為 æ*^äS¡æ¬,¬é€^å-é¥-回.pdf）



## AI分析功能改進
- [x] 設計AI分析結果的資料結構（難度評估、答題表現、建議加強知識點、推薦考題）
- [x] 實作AI分析功能，整合LLM生成智慧建議
- [x] 在檔案列表中顯示AI分析狀態和摘要
- [x] 建立AI分析詳細頁面，完整呈現AI分析結果
- [x] 支援重新分析功能



## Bug修復 - 姓名識別誤判
- [ ] 修正姓名識別邏輯，過濾非姓名後綴詞（例如：「湯芸琇測驗.pdf」應識別為「湯芸琇」而非「湯芸琇測」，「測驗」不應被視為姓名）
- [ ] 清理資料庫中已誤判的人員資料（湯芸琇測、測驗、林嘉容測等）



## 新增AI分析獨立頁面
- [x] 建立AI分析頁面元件（/ai-analysis）
- [x] 在導航列中新增AI分析選項（位置：日曆檢視下方、檔案管理上方）
- [x] 設計AI分析頁面UI（顯示所有分析記錄、支援篩選和搜尋）



## Logo和導航改進
- [x] 將晨陽Logo放在側邊欄左上方
- [x] 更新favicon為晨陽Logo
- [x] 所有頁面新增返回首頁功能（點擊Logo）

## AI分析頁面重新設計
- [x] 移除檔案列表和「查看AI分析」按鈕
- [x] 新增檔案選擇器（支援複選）
- [x] 新增提示詞輸入欄位（支援老師級功能，例如：從題庫選擇10個是非、10個選擇、4個問答）
- [x] 分析結果顯示在同一頁面下方

## 分析結果匯出功能
- [x] 支援匯出為PDF檔
- [x] 支援匯出為Word檔


## 檔案預視功能
- [x] 在檔案列表中新增「預視」按鈕
- [x] 建立檔案預視對話框元件
- [x] 支援PDF檔案預視
- [x] 支援Word檔案預視（顯示提取的文字內容）
- [x] 支援圖片檔案預視覽



## AI分析功能改進 - 分析類型和出題功能
- [x] 新增「分析類型」下拉選單（出考題、題目分析、其他）
- [x] 根據選擇的類型自動調整提示詞前綴
- [x] 實作AI出考題功能（從題庫選擇題目）
- [x] 實作AI題目分析功能（綜合比較多個檔案）
- [x] 更新首頁和頁首文字為「晨陽設計新人考核測驗」



## 姓名識別邏輯優化
- [x] 分析現有姓名識別邏輯
- [x] 建立非姓名詞彙過濾清單（測、測驗等）
- [x] 實作優化的姓名提取邏輯
- [x] 清理資料庫中誤判的人員資料（湯芸琇測、測驗、林嘉容測等）
- [x] 測試姓名識別功能




## Bug修復 - AI分析頁面錯誤
- [x] 修復AI分析頁面的TypeError錯誤（Cannot read properties of undefined）
- [x] 檢查並修正前端程式碼中的undefined變數

## AI分析頁面功能增強
- [x] 在AI分析頁面新增檔案預視功能
- [x] 支援PDF、Word、文字檔案的預視
- [x] 預視對話框整合到分析流程中

## 題庫管理系統
- [x] 設計題庫資料庫schema（題目、選項、答案、分類、難度）
- [x] 建立題庫管理頁面（編輯者以上可見）
- [x] 實作新增考題功能（是非題、選擇題、問答題）
- [x] 實作編輯考題功能
- [x] 實作刪除考題功能
- [x] 實作題目分類功能（部門、主題）
- [x] 實作難度標記功能（簡單、中等、困難）
- [x] 整合AI出題功能，從題庫智能選題




## AI分析頁面導航優化
- [x] 新增頁面標題區塊
- [x] 新增返回首頁按鈕
- [x] 測試導航功能




## 首頁連結修正
- [x] 修正AI分析卡片連結（應連接到/ai-analysis而非/files）
- [x] 測試所有首頁卡片連結


